{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main-compiled.js","sourcesContent":["/**\r\n * Created by Gong on 2016/4/26.\r\n */\r\n\r\n(function(window, document) {\r\n    \"use strict\";\r\n\r\n    class DragUpload {\r\n\r\n\r\n\r\n        constructor(param) {\r\n            this.wrap = $(param.wrap);\r\n            this.upload = $('#upload', this.wrap);\r\n            this.process = $('#upload-list', this.wrap);\r\n            this.imgCounter = 0;\r\n\r\n            /*let local = localStorage.getItem('list') || '';\r\n\r\n            this.process.innerHTML = local;*/\r\n\r\n            this.init();\r\n        }\r\n\r\n        init() {\r\n\r\n            let self = this,\r\n                files,\r\n                uploadBtn = $('.upload-btn', self.upload);\r\n\r\n            self.upload.addEventListener('drop', (event) => {\r\n\r\n                event.preventDefault();\r\n\r\n                files = event.dataTransfer.files;\r\n\r\n                self.handle(files);\r\n            });\r\n\r\n            uploadBtn.addEventListener('change', (event) => {\r\n                self.handle(uploadBtn.files);\r\n            });\r\n        }\r\n\r\n        handle(files) {\r\n\r\n            let self = this,\r\n                file,\r\n                img,\r\n                name,\r\n                size,\r\n                li,\r\n                html,\r\n                formData,\r\n                xhr,\r\n                i;\r\n\r\n            if(!files || !files.length) return;\r\n\r\n            file = files[0];\r\n\r\n            for (i = 0; i < files.length; i++) {\r\n\r\n                file = files[i];\r\n\r\n                if(file.type.indexOf('image') < 0) {\r\n                    alert('File is not an image');\r\n                    return;\r\n                }\r\n\r\n                img = window.URL.createObjectURL(file);\r\n                name = file.name;\r\n                size = Math.floor(file.size / 1024);\r\n                size = size > 1024 ? (size / 1024).toFixed(2) + ' MB' : size + ' KB';\r\n\r\n                let id = 'pic-' + self.imgCounter++\r\n                li = document.createElement('li');\r\n                li.id = id;\r\n\r\n                html = `\r\n                <div class=\"img-cover loading\" style=\"background-image: url('${img}')\">\r\n                    <div class=\"info\">\r\n                        <header>\r\n                            <h3>${name}</h3>\r\n                            <p>${size}</p>\r\n                        </header>\r\n                        <div class=\"link\">\r\n                            <div>\r\n                                <label class=\"thumb-label\">Thumb</label><input type=\"text\" class=\"thumb\">\r\n                            </div>\r\n                            <div>\r\n                                <label class=\"large-label\">Large</label><input type=\"text\" class=\"large\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>`;\r\n\r\n                li.innerHTML = html;\r\n\r\n                self.process.appendChild(li);\r\n\r\n                formData = new FormData();\r\n                formData.append('pic', file);\r\n\r\n                new Promise((resolve, reject) => {\r\n\r\n                    xhr = new XMLHttpRequest();\r\n                    xhr.open('post', 'http://geeku.work/wbu/u/upload.php', true);\r\n                    xhr.send(formData);\r\n\r\n                    xhr.onreadystatechange = () => {\r\n                        if(xhr.readyState == 4) {\r\n                            if((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\r\n                                resolve(JSON.parse(xhr.responseText));\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                }).then((data) => {\r\n\r\n                    if(data.status) {\r\n                        let className = $('#' + id + ' .img-cover', self.process).className,\r\n                            thumb = $('#' + id + ' .thumb', self.process),\r\n                            large = $('#' + id + ' .large', self.process),\r\n                            thumbLabel = $('#' + id + ' .thumb-label', self.process),\r\n                            largeLabel = $('#' + id + ' .large-label', self.process);\r\n\r\n                        $('#' + id + ' .img-cover', self.process).className =className.replace('loading', '');\r\n                        thumb.value = data.thumb;\r\n                        large.value = data.large;\r\n\r\n                        thumbLabel.addEventListener('click', () => {\r\n                            window.open(data.thumb);\r\n                        });\r\n\r\n                        largeLabel.addEventListener('click', () => {\r\n                            window.open(data.large);\r\n                        });\r\n\r\n                        //localStorage.setItem('list', self.process.innerHTML);\r\n\r\n                    } else {\r\n                        alert(data.msg);\r\n                    }\r\n                });\r\n            }\r\n\r\n\r\n        }\r\n    }\r\n\r\n    new DragUpload({\r\n        wrap: '#wrap',\r\n        upload: '.upload-area',\r\n        process: '#upload-list'\r\n    });\r\n\r\n    //Remove document dragxxx event\r\n    const dragx = ['dragenter', 'dragover', 'dragleave', 'drop'];\r\n    dragx.forEach((item) => {\r\n        document.addEventListener(item, (event) => {\r\n            event.preventDefault();\r\n        });\r\n    });\r\n\r\n    function $(selector, context) {\r\n        if(context) {\r\n            return context.querySelector(selector);\r\n        }\r\n        return document.querySelector(selector);\r\n    }\r\n\r\n    function $$(selector, context) {\r\n        if(context) {\r\n            return context.querySelectorAll(selector);\r\n        }\r\n        return document.querySelectorAll(selector);\r\n    }\r\n\r\n    function log(c) {\r\n        console.log(c);\r\n    }\r\n})(window, document);\r\n"]}